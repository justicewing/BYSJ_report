H_hat =[H_A;eye(Nr)/sqrt(sigma2)];
[Q,R]=qr(H_hat);
Q_1 = Q(1:Nu,:);
Q_2 =Q(Nu+1:end,:);
W = (H_A'*H_A + eye(Nr)/sigma2)\H_A';
W_1 =(H_hat'*H_hat)\H_A';
W_2 =(R'*R)\H_A';
H_p=(R'*Q_1')';
R_3=R*R'/sqrt(sigma2);
R_2=Q_2*R*sqrt(sigma2);
W_3 =(R)*Q_1'/sqrt(sigma2);